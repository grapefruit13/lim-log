---
title: '(ë¦¬íŒ©í„°ë§ 2íŒ) ch04. í…ŒìŠ¤íŠ¸ êµ¬ì¶•í•˜ê¸°'
description: 'ì§ì ‘ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ë³´ì'
categories: ['ë¦¬íŒ©í„°ë§', 'TDD', 'í…ŒìŠ¤íŠ¸ì½”ë“œ', 'test']
thumbnail: "https://sprint-fe-project.s3.ap-northeast-2.amazonaws.com/globalnomad/profile_image/2-3_116_1720775384274.avif"
createdAt: 2024-05-16
minsToRead: 15
---

## ğŸ’ ìê°€ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ê°€ì¹˜

> ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ ì™„ì „íˆ ìë™í™”í•˜ê³  ê·¸ ê²°ê³¼ê¹Œì§€ ìŠ¤ìŠ¤ë¡œ ê²€ì‚¬í•˜ê²Œ ë§Œë“¤ì
> 

> í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸(test suite)ëŠ” ê°•ë ¥í•œ ë²„ê·¸ ê²€ì¶œ ë„êµ¬ë¡œ, ë²„ê·¸ë¥¼ ì°¾ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ëŒ€í­ ì¤„ì—¬ì¤€ë‹¤
> 

### íšŒê·€ ë²„ê·¸ regresstion bug

ì˜ ì‘ë™í•˜ë˜ ê¸°ëŠ¥ì—ì„œ ë¬¸ì œê°€ ìƒê¸°ëŠ” í˜„ìƒìœ¼ë¡œ, ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì„ ë³€ê²½í•˜ë‹¤ê°€ ëœ»í•˜ì§€ ì•Šê²Œ ë°œìƒí•œë‹¤.

### íšŒê·€ í…ŒìŠ¤íŠ¸ regresstion test

ì˜ ì‘ë™í•˜ë˜ ê¸°ëŠ¥ì´ ì—¬ì „íˆ ì˜ ì‘ë™í•˜ëŠ” ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸

### âŒ› í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ê¸° ì¢‹ì€ ì‹œì ?

- í”„ë¡œê·¸ë˜ë°ì„ ì‹œì‘í•˜ê¸° ì „!

#### í”„ë¡œê·¸ë˜ë° ì‹œì‘ ì „ì— í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í–ˆì„ ë•Œì˜ ì¥ì 

1. ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ ë¬´ì—‡ì´ í•„ìš”í•œ ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤.
2. `êµ¬í˜„`ë³´ë‹¤ `ì¸í„°í˜ì´ìŠ¤`ì— ì§‘ì¤‘í•˜ê²Œ ëœë‹¤
3. ì½”ë”©ì´ ì™„ë£Œë˜ëŠ” ì‹œì ì„ ì •í™•í•˜ê²Œ íŒë‹¨í•  ìˆ˜ ìˆë‹¤ 
  â†’ ì½”ë“œ ì™„ì„± ì‹œì  = í…ŒìŠ¤íŠ¸ë¥¼ ëª¨ë‘ í†µê³¼í•œ ì‹œì 

### ğŸ§ª TDD í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ

`í…ŒìŠ¤íŠ¸-ì½”ë”©-ë¦¬íŒ©í„°ë§` ê³¼ì •ì„  ì§§ì€ ì£¼ê¸°ë¡œ ë°˜ë³µí•˜ë©° ê°œë°œí•˜ëŠ” ê²ƒ

1. í†µê³¼í•˜ì§€ ëª»í•  í…ŒìŠ¤íŠ¸ ì‘ì„±
2. í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼í•˜ê²Œë” ì½”ë“œ ì‘ì„±
3. ê²°ê³¼ ì½”ë“œë¥¼ ê¹”ë”í•˜ê²Œ ë¦¬íŒ©í„°ë§

---

## ğŸ§‘ğŸ»â€ğŸ­ í…ŒìŠ¤íŠ¸ í™˜ê²½ ì„¸íŒ…

ì±…ì—ì„œëŠ” [mocha](https://mochajs.org/)ì™€ [chai](https://www.chaijs.com/)ë¥¼ í†µí•´ ì‹¤ìŠµí•˜ê¸°ì— ì•„ë˜ì²˜ëŸ¼ í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì„¸íŒ…í–ˆë‹¤.


#### package.json

```json
{
  "scripts": {
    "test": "mocha"
  },
  "devDependencies": {
    "chai": "^5.1.1",
    "mocha": "^10.4.0"
  },
  "type": "module"
}
```

#### í´ë” íŠ¸ë¦¬

```json
src
|-logic.js
test
|-logic.test.js
```

---

## ğŸ‘¨ğŸ»â€ğŸ’» ìƒ˜í”Œ ì½”ë“œ
ìƒ˜í”Œ ì½”ë“œ `src/logic.js`ì˜ ì½”ë“œë“¤ì´ë‹¤.

#### 1ï¸âƒ£ Province í´ë˜ìŠ¤

```jsx
// src/logic.js
export class Province {
  // ìƒì„±ì í•¨ìˆ˜
  constructor(doc) {
    this._name = doc.name;
    this._producers = [];
    this._totalProduction = 0;
    this._demand = doc.demand;
    this._price = doc.price;
    doc.producers.forEach((d) => this.addProducer(new Producer(this, d)));
  }

  // ìƒì‚°ì ì¶”ê°€ í•¨ìˆ˜
  addProducer(arg) {
    // producer ë°°ì—´ì— ì•„ê·œë¨¼íŠ¸ ì¶”ê°€
    this._producers.push(arg);
    // ì•„ê·œë¨¼íŠ¸ productionì„ totalProductionì— í•©ì‚°
    this._totalProduction += arg.production;
  }

  // getterì™€ setter í•¨ìˆ˜ë“¤
  get name() {
    return this._name;
  }

  get producers() {
    return this._producers;
  }
  
  get totalProduction() {
    return this._totalProduction;
  }
  
  set totalProduction(arg) {
    this._totalProduction = arg;
  }
  
  get demand() {
    return this._demand;
  }
  
  set demand(arg) {
    // UIì—ì„œ ì…ë ¥ë°›ì€ ë¬¸ìì—´ì„ ìˆ«ìë¡œ íŒŒì‹±
    this._demand = parseInt(arg);
  }
  
  get price() {
    return this._price;
  }
  
  set price(arg) {
    // UIì—ì„œ ì…ë ¥ë°›ì€ ë¬¸ìì—´ì„ ìˆ«ìë¡œ íŒŒì‹±
    this._price = parseInt(arg);
  }

  // ìƒì‚° ë¶€ì¡±ë¶„ ê³„ì‚°
  get shortfall() {
    // ìˆ˜ìš” - ì´ ìƒì‚°ëŸ‰ = ìƒì‚° ë¶€ì¡±ë¶„
    return this._demand - this.totalProduction;
  }

  // ìˆ˜ìµ ê³„ì‚°
  get profit() {
    // ìˆ˜ìš”ê°€ì¹˜ - ìˆ˜ìš”ë¹„ìš© = ìˆ˜ìµ
    return this.demandValue - this.demandCost;
  }

  // ìˆ˜ìš” ê°€ì¹˜
  get demandValue() {
    // ì¶©ì¡± ìˆ˜ìš” * ê°€ê²©
    return this.satisfiedDemand * this.price;
  }

  // ì¶©ì¡± ìˆ˜ìš”
  get satisfiedDemand() {
    // ìˆ˜ìš”ì™€ ì´ ìƒì‚°ëŸ‰ ì¤‘ ì‘ì€ ê°’
    return Math.min(this._demand, this.totalProduction);
  }

  // ìˆ˜ìš” ë¹„ìš© ê³„ì‚°
  get demandCost() {
    // ìˆ˜ìš”ë¥¼ ë‚¨ì•„ìˆëŠ” ìˆ˜ìš”ì— í• ë‹¹
    let remainingDemand = this.demand;
    // ê²°ê³¼ ë³€ìˆ˜ ì„ ì–¸
    let result = 0;
    this.producers
      // ìƒì‚°ì ë°°ì—´ì˜ ìš”ì†Œë¥¼ ê°€ê²© ë‚®ì€ ìˆœìœ¼ë¡œ ì •ë ¬
      .sort((a, b) => a.cost - b.cost)
      // ë‚¨ì•„ìˆëŠ” ìˆ˜ìš”ì™€ ìƒì‚°ëŸ‰ ì¤‘ ì‘ì€ ê°’ì„ ê¸°ì—¬ì— í• ë‹¹
      .forEach((p) => {
        const contribution = Math.min(remainingDemand, p.production);
        // ë‚¨ì•„ìˆëŠ” ìˆ˜ìš”ì—ì„œ ê¸°ì—¬ë¶„ë§Œí¼ ì°¨ê°
        remainingDemand -= contribution;
        // ìˆ˜ìš” ë¹„ìš© = (ê¸°ì—¬ * ê°€ê²©)ì˜ ì´í•©ì‚°
        result += contribution * p.cost;
      });
    return result;
  }
}
```

#### 2ï¸âƒ£ sampleProvinceData í•¨ìˆ˜

```jsx
export function sampleProvinceData() {
  return {
    name: "asia",
    producers: [
      { name: "Byzantium", cost: 10, production: 9 },
      { name: "Attalia", cost: 12, production: 10 },
      { name: "Sinope", cost: 10, production: 6 },
    ],
    demand: 30,
    price: 20,
  };
}
```

#### 3ï¸âƒ£ Producer í´ë˜ìŠ¤

```jsx
export class Producer {
  // ìƒì„±ì í•¨ìˆ˜
  constructor(aProvince, data) {
    this._province = aProvince;
    this._cost = data.cost;
    this._name = data.name;
    // ìƒì‚°ëŸ‰ì´ ìˆìœ¼ë©´ ìƒì‚°ëŸ‰ì„ ë„£ê³  ì•„ë‹ ê²½ìš°ì—ëŠ” 0ì„ í• ë‹¹
    this._production = data.production || 0;
  }

  get name() {
    return this._name;
  }

  get cost() {
    return this._cost;
  }
  
  set cost(arg) {
    // UIì—ì„œ ì…ë ¥ë°›ì€ ë¬¸ìì—´ì„ ìˆ«ìë¡œ íŒŒì‹±
    this._cost = parseInt(arg);
  }

  get production() {
    return this._production;
  }

  set production(amoutStr) {
    const amount = parseInt(amoutStr);
    const newProduction = Number.isNaN(amount) ? 0 : amount;
    this._province.totalProduction += newProduction - this._production;
    this._production = newProduction;
  }
}

```
---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± `test/logic.test.ts`

### 1ï¸âƒ£ ìƒì‚° ë¶€ì¡±ë¶„ ê³„ì‚° ë¡œì§ í…ŒìŠ¤íŠ¸

```jsx
import { assert } from "chai";
import { Province, sampleProvinceData } from "../src/logic.js";

describe("ìƒì‚° ë¶€ì¡± ê³„ì‚° ë¡œì§ í…ŒìŠ¤íŠ¸", function () {
  it("shortfall", function () {
    // 1. í”½ìŠ¤ì²˜ ì„¤ì • : í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ë°ì´í„°ì™€ ê°ì²´ì¸ í”½ìŠ¤ì³ fixture ì„¤ì •
    const asia = new Province(sampleProvinceData());
    // 2. ê²€ì¦ : ì£¼ì–´ì§„ ì´ˆê¹ƒê°’ì— ê¸°ì´ˆí•˜ì—¬ ìƒì‚° ë¶€ì¡±ë¶„ì„ ê³„ì‚°í–ˆëŠ” ì§€ ê²€ì¦
    assert.equal(asia.shortfall, 5);
  });
});
```

### 2ï¸âƒ£ ì´ ìˆ˜ìµ ê³„ì‚° ë¡œì§ í…ŒìŠ¤íŠ¸

```jsx
// ...

describe("ì´ ìˆ˜ìµ ê³„ì‚° ë¡œì§ í…ŒìŠ¤íŠ¸", function () {
  it("profit", function () {
    const asia = new Province(sampleProvinceData());
    expect(asia.profit).equal(230);
  });
});
```

- í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‚´í´ë³´ë©´, `í”½ìŠ¤ì²˜`ë¥¼ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì—ì„œ `ì½”ë“œ ì¤‘ë³µ`ì´ ìˆë‹¤.
> ì¼ë°˜ ì½”ë“œì™€ ë§ˆì°¬ê°€ì§€ë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œë„ ì¤‘ë³µì€ ì˜ì‹¬í•´ë³´ì•„ì•¼ í•œë‹¤.
>

### ğŸ’€ ì˜ëª»ëœ ì˜ˆì‹œ

```jsx
describe("province", function () {
  const asia = new Province(sampleProvinceData()); // <- ì˜ëª»ëœ ë¶€ë¶„

  it("shortfall", function () {
    assert.equal(asia.shortfall, 5);
  });

  it("profit", function () {
    expect(asia.profit).equal(230);
  });
});
```

#### â” ì´ìœ ëŠ”?

- í…ŒìŠ¤íŠ¸ë¼ë¦¬ ìƒí˜¸ì‘ìš©í•˜ê²Œ í•˜ëŠ” **ê³µìœ  í”½ìŠ¤ì²˜**ë¥¼ ìƒì„±í•˜ê²Œ ë˜ì–´, ë²„ê·¸ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
- ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ `const` í‚¤ì›Œë“œëŠ” `asia ê°ì²´ì˜ ë‚´ìš©`ì´ ì•„ë‹ˆë¼ `asiaë¥¼ ê°€ë¦¬í‚¤ëŠ” ì°¸ì¡°`ê°€ ìƒìˆ˜ì„ì„ ëœ»í•œë‹¤. ë‚˜ì¤‘ì— ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì—ì„œ ì´ ê³µìœ  ê°ì²´ì˜ ê°’ì„ ìˆ˜ì •í•˜ë©´ ì´ í”½ìŠ¤ì²˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë˜ ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆë‹¤. 
â†’ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ìˆœì„œì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.

### ğŸ˜‡ ì¢‹ì€ ì˜ˆì‹œ

```jsx
import { beforeEach } from "mocha";
import { Province, sampleProvinceData } from "../src/logic";

describe("province", function () {
  let asia = new Province(sampleProvinceData());
  beforeEach(function () {
    asia = new Province(sampleProvinceData());
  });

  it("shortfall", function () {
    assert.equal(asia.shortfall, 5);
  });

  it("profit", function () {
    expect(asia.profit).equal(230);
  });
});
```

- `beforeEach` ëŠ” ê°ê°ì˜ í…ŒìŠ¤íŠ¸ ë°”ë¡œ ì „ì— ì‹¤í–‰ë˜ì–´ asiaë¥¼ ì´ˆê¸°í™”í•œë‹¤.
- ê°œë³„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ í”½ìŠ¤ì²˜ë¥¼ ìƒˆë¡œ ë§Œë“¤ë©´ ëª¨ë“  í…ŒìŠ¤íŠ¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.

### ğŸŒŸ `it` ë¸”ë¡ì—ì„œ í”½ìŠ¤ì²˜ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒê³¼ `beforeEach`ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì˜ ì°¨ì´ì 

- í›„ìëŠ” í…ŒìŠ¤íŠ¸ë“¤ì´ ëª¨ë‘ ë˜‘ê°™ì€ í”½ìŠ¤ì²˜ì— ê¸°ì´ˆí•˜ì—¬ ê²€ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ë³´ì¥í•œë‹¤.
â†’ ì¦‰, `í‘œì¤€ í”½ìŠ¤ì²˜` ì‚¬ìš©ì„ ë³´ì¥í•œë‹¤.